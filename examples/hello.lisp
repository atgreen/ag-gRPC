;;;; Generated from examples/hello.proto

;;;; Generated by ag-proto-cli v0.1.0

(in-package "COMMON-LISP-USER")


(DEFCLASS HELLOREQUEST (AG-PROTO:PROTO-MESSAGE)
          ((NAME :INITARG :NAME :ACCESSOR NAME :INITFORM "" :TYPE STRING))
          (:DOCUMENTATION "Proto message: HelloRequest"))


(DEFMETHOD AG-PROTO:SERIALIZE-TO-BYTES ((AG-PROTO::OBJ HELLOREQUEST))
  (LET ((AG-PROTO::BUFFER
         (MAKE-ARRAY 64 :ELEMENT-TYPE '(UNSIGNED-BYTE 8) :FILL-POINTER 0
                     :ADJUSTABLE T)))
    (LET ((AG-PROTO::VALUE (SLOT-VALUE AG-PROTO::OBJ 'NAME)))
      (WHEN (AND AG-PROTO::VALUE (PLUSP (LENGTH AG-PROTO::VALUE)))
        (AG-PROTO::WRITE-FIELD-TAG 1 2 AG-PROTO::BUFFER)
        (AG-PROTO::WRITE-LENGTH-DELIMITED
         (AG-PROTO::STRING-TO-UTF8 AG-PROTO::VALUE) AG-PROTO::BUFFER)))
    AG-PROTO::BUFFER))


(DEFMETHOD AG-PROTO:DESERIALIZE-FROM-BYTES
           ((TYPE (EQL 'HELLOREQUEST)) AG-PROTO::DATA)
  (LET ((AG-PROTO::OBJ (MAKE-INSTANCE 'HELLOREQUEST))
        (AG-PROTO::BUFFER (CONS AG-PROTO::DATA 0)))
    (LOOP AG-PROTO::WHILE (< (CDR AG-PROTO::BUFFER) (LENGTH AG-PROTO::DATA))
          DO (LET* ((AG-PROTO::TAG (AG-PROTO::READ-VARINT AG-PROTO::BUFFER))
                    (AG-PROTO::FIELD-NUMBER (ASH AG-PROTO::TAG -3))
                    (AG-PROTO::WIRE-TYPE (LOGAND AG-PROTO::TAG 7)))
               (CASE AG-PROTO::FIELD-NUMBER
                 (1
                  (SETF (SLOT-VALUE AG-PROTO::OBJ 'NAME)
                          (AG-PROTO::UTF8-TO-STRING
                           (AG-PROTO::READ-LENGTH-DELIMITED
                            AG-PROTO::BUFFER))))
                 (OTHERWISE
                  (AG-PROTO::SKIP-FIELD AG-PROTO::BUFFER
                                        AG-PROTO::WIRE-TYPE)))))
    AG-PROTO::OBJ))


(DEFCLASS HELLOREPLY (AG-PROTO:PROTO-MESSAGE)
          ((MESSAGE :INITARG :MESSAGE :ACCESSOR MESSAGE :INITFORM "" :TYPE
            STRING))
          (:DOCUMENTATION "Proto message: HelloReply"))


(DEFMETHOD AG-PROTO:SERIALIZE-TO-BYTES ((AG-PROTO::OBJ HELLOREPLY))
  (LET ((AG-PROTO::BUFFER
         (MAKE-ARRAY 64 :ELEMENT-TYPE '(UNSIGNED-BYTE 8) :FILL-POINTER 0
                     :ADJUSTABLE T)))
    (LET ((AG-PROTO::VALUE (SLOT-VALUE AG-PROTO::OBJ 'MESSAGE)))
      (WHEN (AND AG-PROTO::VALUE (PLUSP (LENGTH AG-PROTO::VALUE)))
        (AG-PROTO::WRITE-FIELD-TAG 1 2 AG-PROTO::BUFFER)
        (AG-PROTO::WRITE-LENGTH-DELIMITED
         (AG-PROTO::STRING-TO-UTF8 AG-PROTO::VALUE) AG-PROTO::BUFFER)))
    AG-PROTO::BUFFER))


(DEFMETHOD AG-PROTO:DESERIALIZE-FROM-BYTES
           ((TYPE (EQL 'HELLOREPLY)) AG-PROTO::DATA)
  (LET ((AG-PROTO::OBJ (MAKE-INSTANCE 'HELLOREPLY))
        (AG-PROTO::BUFFER (CONS AG-PROTO::DATA 0)))
    (LOOP AG-PROTO::WHILE (< (CDR AG-PROTO::BUFFER) (LENGTH AG-PROTO::DATA))
          DO (LET* ((AG-PROTO::TAG (AG-PROTO::READ-VARINT AG-PROTO::BUFFER))
                    (AG-PROTO::FIELD-NUMBER (ASH AG-PROTO::TAG -3))
                    (AG-PROTO::WIRE-TYPE (LOGAND AG-PROTO::TAG 7)))
               (CASE AG-PROTO::FIELD-NUMBER
                 (1
                  (SETF (SLOT-VALUE AG-PROTO::OBJ 'MESSAGE)
                          (AG-PROTO::UTF8-TO-STRING
                           (AG-PROTO::READ-LENGTH-DELIMITED
                            AG-PROTO::BUFFER))))
                 (OTHERWISE
                  (AG-PROTO::SKIP-FIELD AG-PROTO::BUFFER
                                        AG-PROTO::WIRE-TYPE)))))
    AG-PROTO::OBJ))

